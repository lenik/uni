#!/bin/bash
# master-file

shopt -s nullglob

suffix=
case `arch` in
    x86_64) suffix=-64;;
esac
nsuffix="${#suffix}"

jdk_latest=
for jdkdir in /opt/java/jdk-*; do
    [ -x "$jdkdir/bin/javac" ] || continue
    base="${jdkdir##*/}"
    if [ "${base: -nsuffix}" = "$suffix" ]; then
        jdk_latest="$jdkdir"
    fi
done

if [ -z "$jdk_latest" ]; then
    echo "No JDK installation found in /opt/java/jdk-*$suffix" >&2
    exit 1
fi

for bin in "$jdk_latest"/bin/*; do
    [ -x "$bin" ] || continue

    base="${bin##*/}"
    #echo "Make as default: $base -> $bin"
    update-alternatives --install /usr/bin/$base $base \
        "$bin" 10000
done

exit 0

