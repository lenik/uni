#!/bin/bash
# master-file

tex_arch=$( @tex_arch_cmd@ )

instdir=
for texbin in /usr/local/texlive/*/bin/${tex_arch}-linux/tex; do
    if [ -x "$texbin" ]; then
        archbindir=${texbin%/tex}
        bindir=${archbindir%/*}
        instdir=${bindir%/*}
        echo "Found texlive installation: $instdir"
    fi
done

if [ -n "$instdir" ]; then
    echo "Add texlive installation $instdir to environment"
    if [ ! -d @profilesdir@ ]; then
        mkdir -p @profilesdir@
    fi

    profile=@profilesdir@/texlive-local.sh
    cat <<EOM >$profile
PATH=$archbindir:\$PATH

if [ -z "\$MANPATH" ]; then
    MANPATH=$instdir/texmf/doc/man:/usr/share/man
else
    MANPATH=$instdir/texmf/doc/man:\$MANPATH
fi

if [ -z "\$INFOPATH" ]; then
    INFOPATH=$instdir/texmf/doc/info:/usr/share/info
else
    INFOPATH=$instdir/texmf/doc/info:\$INFOPATH
fi

export PATH MANPATH INFOPATH
EOM

else
    echo "No texlive local installation found. "
    echo "You must install texlive before install this package. "
    exit 1
fi

exit 0
