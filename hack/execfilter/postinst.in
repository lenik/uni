#!/bin/sh
# master-file

preloadfile="@sysconfdir@/ld.so.preload"

if [ ! -f "$preloadfile" ] || ! grep -q libexecfilter "$preloadfile"; then
    echo "Add libexecfilter to preloaded library list."
    echo libexecfilter.so >>"$preloadfile"
    echo 1 >"$preloadfile-dummy"
fi

# This file need to be worldwide readable.
chmod +r "$preloadfile"

# The module must be suid, or it will be ignored when it's linked with suid app.
shopt -s nullglob
chmod +xs "@libdir@"/libexecfilter.so.*

exit 0
