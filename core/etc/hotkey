#NoTrayIcon
#SingleInstance ignore

setworkingdir %USERPROFILE%

funpack(count, prefix) {
	global
	local index = 0
	local pid
	loop %count% {
		pid := %prefix%_p%a_index%
		if pid {
			process, exist, % pid
			if errorlevel {
				continue
			}
		}
		index := a_index
		break
	}
	if index {
		local prog = %prefix%%index%
		run, %prog%, , , %prefix%_p%index%
	}
}

runp(pre, cmd) {
	regwrite, REG_SZ, HKEY_LOCAL_MACHINE, SOFTWARE\Microsoft\Command Processor, AutoRun, %pre%
	run %cmd%
}

!tab::send {escape}{tab}
lwin & tab::alttab
lwin & capslock::shiftalttab

#!e::edit
#!r::reload
#!p::pause
#!s::suspend
#!bs::exitapp
#!h::
	splitpath, a_ahkpath, name, dir
	run % dir . "/autohotkey.chm"
	return
#!/::
	if A_IconHidden {
		menu, tray, icon
	} else {
		menu, tray, noicon
	}
	return

appskey::send {appskey}
appskey & down::send {media_play_pause}
appskey & up::send {media_stop}
appskey & left::send {media_prev}
appskey & right::send {media_next}
appskey & numpadadd::send {volumn_up}
appskey & numpadsub::send {volumn_down}

#pgup::wheelup
#pgdn::wheeldown

#a::run cmdw /c start "ANSI" %LAPIOTA%\bin\lapiota-init login
#b::run cmdw /c start "Big" %LAPIOTA%\bin\lapiota-init login
#c::run cmd /k %LAPIOTA%\bin\lapiota-init login
#f::run firefox
#m::run metapad
#n::run cmdw /c no
#s::run cmdw /c scilab
#t::run %SHELL% --login
#x::run startx
#-::
	nfs1 = %perlw% /lapiota/bin/nfs.pl --wait-close
	nfs2 = %perlw% /lapiota/bin/nfs.pl --wait-close temp-
	nfs3 = %perlw% /lapiota/bin/nfs.pl --wait-close xxx-
	funpack(3, "nfs")
	return
#=::
	calc1 = cmdw /c start "Cart" cmd /c settitle "1 + 1 = 2" bc -ilq
	funpack(1, "calc")
	return

#,::run stairs
#u::run ue

#+e::run cmdw /c em
#+d::
	ifexist C:\ntddk
		run ntddk
	return
#+p::
	ifexist C:\strawberry-perl
		run perldev
	return
