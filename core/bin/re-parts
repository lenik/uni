#!perl
# $Id: re-parts,v 1.4 2006-11-17 20:28:09 lenik Exp $

# re-parts <regex> ...

use strict;

my $re = shift @ARGV;

print "parts analyse of (perl)regular-expression\n";
print "regex: $re\n\n";

my $line = 0;
while (<>) {
	chop;
	my $part = 0;
	if (!m/$re/) {
		print "    <NOT MATCHED!>\n";
		next;
	}

	print "L$line: \n"; #$_\n    ";

	my $info;
	while (m/$re/g) {
		#print "$`|" if ($part == 0);
		$info = "    $`<$&>$'  | $-[0] $-[1] $-[2] $-[3] $-[4] $-[5] $-[6] $-[7]";
		$info =~ s/\s*$//;
		print "$info\n";
		$part++;
	}
	print "\n";

	if (m/$re/) {
		print "    Pos=[@-]\n";
		print "    \$1^$-[1]: \"$1\"\n" if $1;
		print "    \$2^$-[2]: \"$2\"\n" if $2;
		print "    \$3^$-[3]: \"$3\"\n" if $3;
		print "    \$4^$-[4]: \"$4\"\n" if $4;
		print "    \$5^$-[5]: \"$5\"\n" if $5;
		print "    \$6^$-[6]: \"$6\"\n" if $6;
		print "    \$7^$-[7]: \"$7\"\n" if $7;
		print "    \$8^$-[8]: \"$8\"\n" if $8;
		print "    \$9^$-[9]: \"$9\"\n" if $9;
		print "    \$&: \"$&\"\n";
		print "\n";
	}

	$line++;
}



__END__

    # Useful Regular Expression Routines

    # Complex-Replacement based:
            my $newtext = '';
            my $posmark = 0;
            while ($oldtext =~ m/ (regex-1) | (regex-2) /xg) {
		$newtext .= substr($oldtext, $posmark, $-[0] - $posmark);
		if ($1) {
			$newtext .= "Replacement-1";
		}
                if ($2) {
			$newtext .= "Replacement-2";
		}
		$posmark = $-[0] + length($&);
            }
            $newtext .= substr($oldtext, $posmark);
