function _hm() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    local cachef=/var/tmp/hm.packages

    if [ $COMP_CWORD = 1 ]; then
        make1 -qoT 1wk $cachef \; hm -p
        COMPREPLY=( $( grep "^$cur" $cachef ) )
    else
        local package="${COMP_WORDS[1]}"
        COMPREPLY=( $( hm -al "$package" "$cur" | cut -f1 ) )
    fi
    return 0
} && complete -F _hm hm
