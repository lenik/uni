#!/bin/sh

# 1, do vercomp before commit
# 2, do update after commit on dir

if [ -z "$SVN" ]; then
    SVN=svn
fi

case "$1" in
    commit|ci)
        av=
        for d in . .. ../..; do
            if [ -f "$d/VERSION.av" ]; then
                av="$d/VERSION.av"
                break
            fi
        done
        if [ -n "$av" ]; then
            vercomp -i commit "$av"
            if AUTOVER=`which autover`; then
                $AUTOVER
            fi
        fi
        ;;
esac

$SVN "$@"
